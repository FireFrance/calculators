<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>FireFrance calculators</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="FireFrance calculators">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>
<body>
  <div class="card">
    <div class="card-body">
    <header>
      <h1>PEA comparison simulator</h1>
    </header>

    <p>
      This calculator will simulate the accumulation of savings in a PEA over time, based on a starting amount and a fixed monthly contribution.
      When the PEA's limit of 150,000 euros is hit, contributions will automatically be stopped as close to the max as possible, and the funds will
      continue to grow from then until the end of the period. It will then provide an estimated income you can draw from the PEA based on prefered
      safe withdrawal rate. 
    </p>
    
    <p>
      All calculations are based on current estimates of the fees of each provider, which can be complex and could change, but we did our best to take
      everything into account correctly.
      See <a href="https://fireuktofrance.wordpress.com/2020/11/29/investing-from-france-best-pea-for-fire/" target="new">our blog post on PEAs for more details</a>
    </p>
    <p>
      The calculator provides a comparison between the best PEA products I found.
      The code is all open source and MIT licensed, so feel free to check it out and clone/fork it if required.
    </p>
    <p>
      All calculators are performed in your browser and no data that you input is sent to any server
    </p>

    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-sm">
            <h3>Simulation options</h2>
            <form id="accumlation">
              <div class="form-group">
                <label for="expectedYearlyGrowthRate">Expected yearly growth in percent.</label>
                <input type="number" class="form-control" name="expectedYearlyGrowthRate" value=7>
              </div>
              <div class="form-group">
                  <label for="numberOfYears">Number of years to accummulate</label>
                  <input type="number" class="form-control" name="numberOfYears" value=15>
              </div>
              <div class="form-group">
                  <label for="startingValue">Initial value</label>
                  <input type="number" class="form-control" name="startingValue" value=0>
              </div>
              <div class="form-group">
                  <label for="monthlyContribution">Monthly contribution</label>
                  <input type="number" class="form-control" name="monthlyContribution" value=833>
              </div>
              <div class="form-group">
                <label for="expenseRatio">Avg expense ratio of funds in account in percent. Amundi MSCI World is 0.38%</label>
                <input type="number" class="form-control" name="expenseRatio" value=0.38>
              </div>
              <div class="form-group">
                <label for="limit">Limit - after which contributions will be stopped</label>
                <input type="number" class="form-control" name="limit" value=150000>
              </div>
              <div class="form-group">
                <label for="withdrawalRate">Withdrawal Rate Percentage - 4% is optimistic, 3% more conservative</label>
                <input type="number" class="form-control" name="withdrawalRate" value=4>
              </div>
              <button type="button" class="btn btn-primary" onclick="submitAccumulation()">Submit</button>
            </form>
          </div>
          <div class="col-sm">
            <h3>Accumulation by year</h2>
              <p>This shows how much would be in each account at the year-end</p>
            <div id="accumlation-table"></div>
            <h3>Withdrawal estimate</h3>
            <p>How much you could withdraw per month after taxes</p>
            <div id="withdrawal-table"></div>
          </div>
        </div>
         
          
    
        <div class="card-body">
         
          </div>
      </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body">
       
        </div>
        </div>
    
    <script src="comparison.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
  <script type="text/javascript">

    let table = null
    let withdrawalTable = null

    function submitAccumulation() {
      const formData = $("#accumlation").serializeArray()

      const parameters = formData.reduce((acc, cur) => (
          {
            ...acc,
            [cur.name]: cur.value
          }
      ), {})

      const { expectedYearlyGrowthRate, startingValue, monthlyContribution, numberOfYears, limit, withdrawalRate, expenseRatio } = parameters

      const growthRatePercent = expectedYearlyGrowthRate / 100

      const graphData = getAccumlationGraphData(growthRatePercent, startingValue, monthlyContribution, numberOfYears, expenseRatio, limit)
      const container = document.getElementById('accumlation-table');

      if (table) {
        const [, ...rest] = graphData
        table.loadData(rest)
      }

      const widthdrawalData = getWithdrawalAmounts(growthRatePercent, startingValue, monthlyContribution, numberOfYears, withdrawalRate, expenseRatio, limit)
      if (withdrawalTable) {
        const [, ...rest] = widthdrawalData
        withdrawalTable.loadData(rest)
      }
    }

    const currencyColumn = {
      type: 'numeric',
      numericFormat: {
        pattern: '0,0.00',
        culture: 'fr-FR'
      }
    }

    $(document).ready(function() {
      const accumulationContainer = document.getElementById('accumlation-table');
      table = new Handsontable(accumulationContainer, {
        data: [],
        rowHeaders: false,
        colHeaders: ['Year', 'Cash Contribution', 'Bourse Direct', 'Boursorama', 'Saxo'],
        licenseKey: 'non-commercial-and-evaluation',
        columns: [
          { type: 'numeric' },
          currencyColumn,
          currencyColumn,
          currencyColumn,
          currencyColumn
        ]
      });

      const withdrawalContainer = document.getElementById('withdrawal-table');
      withdrawalTable = new Handsontable(withdrawalContainer, {
        data: [],
        rowHeaders: false,
        colHeaders: ['', 'Bourse Direct', 'Boursorama', 'Saxo'],
        licenseKey: 'non-commercial-and-evaluation',
        columns: [
          { type: 'text' },
          currencyColumn,
          currencyColumn,
          currencyColumn
        ]
      });

      submitAccumulation()
    })
  </script>
    </div>
    </div>
</body>
</html>